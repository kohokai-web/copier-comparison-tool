<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¤‡åˆæ©Ÿç›¸è¦‹ç©ã‚‚ã‚Šæ¯”è¼ƒè¡¨</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        .category-header {
            background-color: #ecf0f1;
            font-weight: bold;
            color: #2c3e50;
        }
        .sample-data {
            background-color: #e8f5e8;
        }
        .input-field {
            width: 90%;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
        }
        .cost-calculation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .total-cost {
            font-weight: bold;
            font-size: 16px;
            color: #27ae60;
        }
        .note {
            margin-top: 15px;
            padding: 10px;
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            color: #856404;
        }
        .calculation-row {
            background-color: #f1c40f;
            color: #2c3e50;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>è¤‡åˆæ©Ÿç›¸è¦‹ç©ã‚‚ã‚Šæ¯”è¼ƒè¡¨</h1>
        
        <table id="comparisonTable">
            <thead>
                <tr>
                    <th style="width: 200px;">é …ç›®</th>
                    <th style="width: 200px;">æ¥­è€…A<br>ï¼ˆã‚ªãƒ•ã‚£ã‚¹æ¡ƒå¤ªéƒï¼‰</th>
                    <th style="width: 200px;">æ¥­è€…B</th>
                    <th style="width: 200px;">æ¥­è€…C</th>
                    <th style="width: 200px;">æ¥­è€…D</th>
                </tr>
            </thead>
            <tbody>
                <tr class="category-header">
                    <td colspan="5">åŸºæœ¬æƒ…å ±</td>
                </tr>
                <tr>
                    <td>æ¥­è€…å</td>
                    <td class="sample-data">ã‚ªãƒ•ã‚£ã‚¹æ¡ƒå¤ªéƒ</td>
                    <td><input type="text" class="input-field" placeholder="æ¥­è€…åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ¥­è€…åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ¥­è€…åã‚’å…¥åŠ›"></td>
                </tr>
                <tr>
                    <td>æ‹…å½“è€…å</td>
                    <td class="sample-data">æ¤¿æ§˜</td>
                    <td><input type="text" class="input-field" placeholder="æ‹…å½“è€…åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ‹…å½“è€…åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ‹…å½“è€…åã‚’å…¥åŠ›"></td>
                </tr>
                <tr class="category-header">
                    <td colspan="5">æ©Ÿå™¨ä»•æ§˜</td>
                </tr>
                <tr>
                    <td>æ©Ÿç¨®å</td>
                    <td class="sample-data">äº¬ã‚»ãƒ©è£½ã‚«ãƒ©ãƒ¼è¤‡åˆæ©Ÿæœ¬ä½“</td>
                    <td><input type="text" class="input-field" placeholder="æ©Ÿç¨®åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ©Ÿç¨®åã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æ©Ÿç¨®åã‚’å…¥åŠ›"></td>
                </tr>
                <tr>
                    <td>å‹ç•ª</td>
                    <td class="sample-data">TASKalfa3554ci</td>
                    <td><input type="text" class="input-field" placeholder="å‹ç•ªã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="å‹ç•ªã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="å‹ç•ªã‚’å…¥åŠ›"></td>
                </tr>
                <tr>
                    <td>å°åˆ·é€Ÿåº¦</td>
                    <td class="sample-data">35æš/åˆ†</td>
                    <td><input type="text" class="input-field" placeholder="æš/åˆ†"></td>
                    <td><input type="text" class="input-field" placeholder="æš/åˆ†"></td>
                    <td><input type="text" class="input-field" placeholder="æš/åˆ†"></td>
                </tr>
                <tr>
                    <td>ã‚µã‚¤ã‚º</td>
                    <td class="sample-data">A4ï½A3</td>
                    <td><input type="text" class="input-field" placeholder="å¯¾å¿œã‚µã‚¤ã‚º"></td>
                    <td><input type="text" class="input-field" placeholder="å¯¾å¿œã‚µã‚¤ã‚º"></td>
                    <td><input type="text" class="input-field" placeholder="å¯¾å¿œã‚µã‚¤ã‚º"></td>
                </tr>
                <tr>
                    <td>ä¸¡é¢å°åˆ·</td>
                    <td class="sample-data">ã€‡</td>
                    <td><input type="text" class="input-field" placeholder="ã€‡/Ã—"></td>
                    <td><input type="text" class="input-field" placeholder="ã€‡/Ã—"></td>
                    <td><input type="text" class="input-field" placeholder="ã€‡/Ã—"></td>
                </tr>
                <tr class="category-header">
                    <td colspan="5">è²»ç”¨</td>
                </tr>
                <tr>
                    <td>è³¼å…¥é‡‘é¡ï¼ˆç¨è¾¼ï¼‰</td>
                    <td class="sample-data">Â¥495,000</td>
                    <td><input type="number" class="input-field" placeholder="é‡‘é¡ï¼ˆå††ï¼‰" onchange="calculateCost(2)"></td>
                    <td><input type="number" class="input-field" placeholder="é‡‘é¡ï¼ˆå††ï¼‰" onchange="calculateCost(3)"></td>
                    <td><input type="number" class="input-field" placeholder="é‡‘é¡ï¼ˆå††ï¼‰" onchange="calculateCost(4)"></td>
                </tr>
                <tr>
                    <td>ãƒ¢ãƒã‚¯ãƒ­å˜ä¾¡</td>
                    <td class="sample-data">0.6å††/æš</td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(2)"></td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(3)"></td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(4)"></td>
                </tr>
                <tr>
                    <td>ã‚«ãƒ©ãƒ¼å˜ä¾¡</td>
                    <td class="sample-data">6.0å††/æš</td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(2)"></td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(3)"></td>
                    <td><input type="number" step="0.1" class="input-field" placeholder="å††/æš" onchange="calculateCost(4)"></td>
                </tr>
                <tr>
                    <td>æœ€ä½åŸºæœ¬æ–™é‡‘</td>
                    <td class="sample-data">Â¥1,100</td>
                    <td><input type="number" class="input-field" placeholder="å††" onchange="calculateCost(2)"></td>
                    <td><input type="number" class="input-field" placeholder="å††" onchange="calculateCost(3)"></td>
                    <td><input type="number" class="input-field" placeholder="å††" onchange="calculateCost(4)"></td>
                </tr>
                <tr class="category-header">
                    <td colspan="5">æœˆé–“ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆãƒ¢ãƒã‚¯ãƒ­6,000æšãƒ»ã‚«ãƒ©ãƒ¼600æšï¼‰</td>
                </tr>
                <tr class="calculation-row">
                    <td>æœˆé–“å°åˆ·ã‚³ã‚¹ãƒˆ</td>
                    <td class="sample-data">Â¥7,200</td>
                    <td id="monthlyCost2">-</td>
                    <td id="monthlyCost3">-</td>
                    <td id="monthlyCost4">-</td>
                </tr>
                <tr class="calculation-row">
                    <td>å¹´é–“å°åˆ·ã‚³ã‚¹ãƒˆ</td>
                    <td class="sample-data">Â¥86,400</td>
                    <td id="yearlyCost2">-</td>
                    <td id="yearlyCost3">-</td>
                    <td id="yearlyCost4">-</td>
                </tr>
                <tr class="category-header">
                    <td colspan="5">5å¹´é–“ç·è²»ç”¨</td>
                </tr>
                <tr class="total-cost">
                    <td>1å¹´ç›®ç·é¡</td>
                    <td class="sample-data">Â¥581,400</td>
                    <td id="year1Total2">-</td>
                    <td id="year1Total3">-</td>
                    <td id="year1Total4">-</td>
                </tr>
                <tr class="total-cost">
                    <td>2å¹´ç›®ç·é¡</td>
                    <td class="sample-data">Â¥667,800</td>
                    <td id="year2Total2">-</td>
                    <td id="year2Total3">-</td>
                    <td id="year2Total4">-</td>
                </tr>
                <tr class="total-cost">
                    <td>3å¹´ç›®ç·é¡</td>
                    <td class="sample-data">Â¥754,200</td>
                    <td id="year3Total2">-</td>
                    <td id="year3Total3">-</td>
                    <td id="year3Total4">-</td>
                </tr>
                <tr class="total-cost">
                    <td>4å¹´ç›®ç·é¡</td>
                    <td class="sample-data">Â¥840,600</td>
                    <td id="year4Total2">-</td>
                    <td id="year4Total3">-</td>
                    <td id="year4Total4">-</td>
                </tr>
                <tr class="total-cost" style="background-color: #27ae60; color: white;">
                    <td>5å¹´ç›®ç·é¡ï¼ˆæœ€çµ‚ï¼‰</td>
                    <td class="sample-data" style="background-color: #27ae60; color: white;">Â¥927,000</td>
                    <td id="year5Total2" style="background-color: #27ae60; color: white;">-</td>
                    <td id="year5Total3" style="background-color: #27ae60; color: white;">-</td>
                    <td id="year5Total4" style="background-color: #27ae60; color: white;">-</td>
                </tr>
                <tr class="category-header">
                    <td colspan="5">ãã®ä»–æƒ…å ±</td>
                </tr>
                <tr>
                    <td>å¥‘ç´„ã‹ã‚‰ç´å“ã¾ã§</td>
                    <td class="sample-data">1é€±é–“ç¨‹åº¦</td>
                    <td><input type="text" class="input-field" placeholder="æœŸé–“ã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æœŸé–“ã‚’å…¥åŠ›"></td>
                    <td><input type="text" class="input-field" placeholder="æœŸé–“ã‚’å…¥åŠ›"></td>
                </tr>
                <tr>
                    <td>ä¿è¨¼ãƒ»ã‚µãƒ¼ãƒ“ã‚¹</td>
                    <td class="sample-data">5å¹´ä¿è¨¼ãƒ»ãƒ¡ãƒ¼ã‚«ãƒ¼ä¿å®ˆãƒ»ãƒˆãƒŠãƒ¼ä»£ãƒ»å‡ºå¼µè²»ãƒ»éƒ¨å“ä»£è¾¼</td>
                    <td><input type="text" class="input-field" placeholder="ä¿è¨¼å†…å®¹"></td>
                    <td><input type="text" class="input-field" placeholder="ä¿è¨¼å†…å®¹"></td>
                    <td><input type="text" class="input-field" placeholder="ä¿è¨¼å†…å®¹"></td>
                </tr>
                <tr>
                    <td>å‚™è€ƒ</td>
                    <td class="sample-data">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ–™é‡‘åˆè¨ˆãŒåŸºæœ¬æ–™é‡‘ã‚’ä¸‹å›ã‚‹å ´åˆã«åŸºæœ¬æ–™é‡‘é©ç”¨</td>
                    <td><input type="text" class="input-field" placeholder="å‚™è€ƒ"></td>
                    <td><input type="text" class="input-field" placeholder="å‚™è€ƒ"></td>
                    <td><input type="text" class="input-field" placeholder="å‚™è€ƒ"></td>
                </tr>
            </tbody>
        </table>

        <div class="note">
            <h3>ä½¿ç”¨æ–¹æ³•</h3>
            <p><strong>å‰ææ¡ä»¶ï¼š</strong> æœˆé–“å°åˆ·é‡ - ãƒ¢ãƒã‚¯ãƒ­6,000æšã€ã‚«ãƒ©ãƒ¼600æšã§è¨ˆç®—</p>
            <p>1. å„æ¥­è€…ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
            <p>2. è³¼å…¥é‡‘é¡ã€ãƒ¢ãƒã‚¯ãƒ­å˜ä¾¡ã€ã‚«ãƒ©ãƒ¼å˜ä¾¡ã€æœ€ä½åŸºæœ¬æ–™é‡‘ã‚’å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•ã§5å¹´é–“ã®ç·è²»ç”¨ãŒè¨ˆç®—ã•ã‚Œã¾ã™</p>
            <p>3. æœ€ä¸‹æ®µã®ã€Œ5å¹´ç›®ç·é¡ï¼ˆæœ€çµ‚ï¼‰ã€ãŒ5å¹´é–“ã®ç·ã‚³ã‚¹ãƒˆã§ã™</p>
            <p>4. ã“ã®é‡‘é¡ã‚’æ¯”è¼ƒã—ã¦æœ€é©ãªæ¥­è€…ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
            <p>5. å…¥åŠ›å®Œäº†å¾Œã€ä¸‹ã®ãƒœã‚¿ãƒ³ã§Excelãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™</p>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="downloadExcel()" style="background-color: #27ae60; color: white; padding: 12px 24px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
                ğŸ“Š Excelãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        function calculateCost(column) {
            const table = document.getElementById('comparisonTable');
            const rows = table.getElementsByTagName('tr');
            
            // å…¥åŠ›å€¤ã‚’å–å¾—
            let purchasePrice = 0;
            let monoPrice = 0;
            let colorPrice = 0;
            let minCharge = 0;
            
            // å„è¡Œã‹ã‚‰å€¤ã‚’å–å¾—
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells.length > column) {
                    const input = cells[column].getElementsByTagName('input')[0];
                    if (input) {
                        const rowLabel = cells[0].textContent.trim();
                        if (rowLabel === 'è³¼å…¥é‡‘é¡ï¼ˆç¨è¾¼ï¼‰') {
                            purchasePrice = parseFloat(input.value) || 0;
                        } else if (rowLabel === 'ãƒ¢ãƒã‚¯ãƒ­å˜ä¾¡') {
                            monoPrice = parseFloat(input.value) || 0;
                        } else if (rowLabel === 'ã‚«ãƒ©ãƒ¼å˜ä¾¡') {
                            colorPrice = parseFloat(input.value) || 0;
                        } else if (rowLabel === 'æœ€ä½åŸºæœ¬æ–™é‡‘') {
                            minCharge = parseFloat(input.value) || 0;
                        }
                    }
                }
            }
            
            // å…¥åŠ›ãŒãªã„å ´åˆã¯è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢
            if (purchasePrice === 0 && monoPrice === 0 && colorPrice === 0) {
                document.getElementById('monthlyCost' + column).textContent = '-';
                document.getElementById('yearlyCost' + column).textContent = '-';
                document.getElementById('year1Total' + column).textContent = '-';
                document.getElementById('year2Total' + column).textContent = '-';
                document.getElementById('year3Total' + column).textContent = '-';
                document.getElementById('year4Total' + column).textContent = '-';
                document.getElementById('year5Total' + column).textContent = '-';
                return;
            }
            
            // æœˆé–“ã‚³ã‚¹ãƒˆè¨ˆç®—
            const monthlyMono = monoPrice * 6000;
            const monthlyColor = colorPrice * 600;
            const monthlyTotal = Math.max(monthlyMono + monthlyColor, minCharge);
            const yearlyTotal = monthlyTotal * 12;
            
            // çµæœã‚’è¡¨ç¤º
            document.getElementById('monthlyCost' + column).textContent = 'Â¥' + monthlyTotal.toLocaleString();
            document.getElementById('yearlyCost' + column).textContent = 'Â¥' + yearlyTotal.toLocaleString();
            
            // å„å¹´ã®ç´¯è¨ˆã‚’è¨ˆç®—ï¼ˆæœ¬ä½“ä¾¡æ ¼ã¯1å¹´ç›®ã®ã¿åŠ ç®—ï¼‰
            const year1Total = purchasePrice + yearlyTotal;
            const year2Total = purchasePrice + (yearlyTotal * 2);
            const year3Total = purchasePrice + (yearlyTotal * 3);
            const year4Total = purchasePrice + (yearlyTotal * 4);
            const year5Total = purchasePrice + (yearlyTotal * 5);
            
            document.getElementById('year1Total' + column).textContent = 'Â¥' + year1Total.toLocaleString();
            document.getElementById('year2Total' + column).textContent = 'Â¥' + year2Total.toLocaleString();
            document.getElementById('year3Total' + column).textContent = 'Â¥' + year3Total.toLocaleString();
            document.getElementById('year4Total' + column).textContent = 'Â¥' + year4Total.toLocaleString();
            document.getElementById('year5Total' + column).textContent = 'Â¥' + year5Total.toLocaleString();
        }
        
        function downloadExcel() {
            // ãƒ‡ãƒ¼ã‚¿ã‚’åé›†
            const data = [];
            const table = document.getElementById('comparisonTable');
            const rows = table.getElementsByTagName('tr');
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ä½œæˆ
            const headerRow = [];
            const headerCells = rows[0].getElementsByTagName('th');
            for (let i = 0; i < headerCells.length; i++) {
                headerRow.push(headerCells[i].textContent.replace(/\n/g, ' ').trim());
            }
            data.push(headerRow);
            
            // ãƒ‡ãƒ¼ã‚¿è¡Œã‚’å‡¦ç†
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells.length > 0) {
                    const row = [];
                    
                    for (let j = 0; j < cells.length; j++) {
                        const cell = cells[j];
                        
                        // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹å ´åˆ
                        const input = cell.getElementsByTagName('input')[0];
                        if (input) {
                            row.push(input.value || '');
                        } else {
                            // é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯è¨ˆç®—çµæœ
                            let cellText = cell.textContent.trim();
                            // Â¥ãƒãƒ¼ã‚¯ã‚’é™¤å»ã—ã¦æ•°å€¤ã¨ã—ã¦ä¿å­˜
                            if (cellText.startsWith('Â¥')) {
                                cellText = cellText.replace('Â¥', '').replace(/,/g, '');
                                if (!isNaN(cellText) && cellText !== '') {
                                    row.push(parseFloat(cellText));
                                } else {
                                    row.push(cellText);
                                }
                            } else {
                                row.push(cellText);
                            }
                        }
                    }
                    data.push(row);
                }
            }
            
            // Excelãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã‚’ä½œæˆ
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // åˆ—å¹…ã‚’èª¿æ•´
            const colWidths = [
                { wch: 25 }, // é …ç›®åˆ—
                { wch: 20 }, // æ¥­è€…A
                { wch: 20 }, // æ¥­è€…B
                { wch: 20 }, // æ¥­è€…C
                { wch: 20 }  // æ¥­è€…D
            ];
            ws['!cols'] = colWidths;
            
            // ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã‚’ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã«è¿½åŠ 
            XLSX.utils.book_append_sheet(wb, ws, "è¤‡åˆæ©Ÿæ¯”è¼ƒè¡¨");
            
            // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆï¼ˆç¾åœ¨ã®æ—¥ä»˜ã‚’å«ã‚€ï¼‰
            const today = new Date();
            const dateStr = today.getFullYear() + '-' + 
                          String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                          String(today.getDate()).padStart(2, '0');
            const filename = `è¤‡åˆæ©Ÿæ¯”è¼ƒè¡¨_${dateStr}.xlsx`;
            
            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
            XLSX.writeFile(wb, filename);
        }
    </script>
</body>
</html>
